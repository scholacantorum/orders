(function(t){function e(e){for(var i,o,a=e[0],u=e[1],c=e[2],d=0,p=[];d<a.length;d++)o=a[d],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&p.push(r[o][0]),r[o]=0;for(i in u)Object.prototype.hasOwnProperty.call(u,i)&&(t[i]=u[i]);l&&l(e);while(p.length)p.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],i=!0,a=1;a<n.length;a++){var u=n[a];0!==r[u]&&(i=!1)}i&&(s.splice(e--,1),t=o(o.s=n[0]))}return t}var i={},r={"buy-tickets":0},s=[];function o(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=i,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],u=a.push.bind(a);a.push=e,a=a.slice();for(var c=0;c<a.length;c++)e(a[c]);var l=u;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("a2b0")},"02b1":function(t,e,n){},"135e":function(t,e,n){"use strict";var i=n("2b0e"),r=n("5f5b");n("2dd8");i["default"].use(r["a"])},"16bc":function(t,e,n){"use strict";var i=n("fcfa"),r=n.n(i);r.a},"1e9b":function(t,e,n){"use strict";var i=n("f7ff"),r=n.n(i);r.a},"23c60":function(t,e,n){"use strict";var i=n("d635"),r=n.n(i);r.a},"2a60":function(t,e,n){},"42f5":function(t,e,n){"use strict";var i=n("afa0"),r=n.n(i);r.a},6398:function(t,e,n){"use strict";var i=n("2a60"),r=n.n(i);r.a},"6f3f":function(t,e,n){"use strict";var i=n("ff6d"),r=n.n(i);r.a},7534:function(t,e,n){},"7aa3":function(t,e,n){},"905a":function(t,e,n){"use strict";var i=n("7aa3"),r=n.n(i);r.a},"9c02":function(t,e,n){"use strict";var i=n("02b1"),r=n.n(i);r.a},a2b0:function(t,e,n){"use strict";n.r(e);n("744f"),n("6095"),n("6c7b"),n("d25f"),n("7514"),n("20d6"),n("f3e2"),n("1c4c"),n("6762"),n("57e7"),n("2caf"),n("cadf"),n("9865"),n("6d67"),n("e804"),n("0cd8"),n("48f8"),n("759f"),n("55dd"),n("d04f"),n("78ce"),n("8ea5"),n("0298"),n("c8ce"),n("87b3"),n("d92a"),n("217b"),n("7f7f"),n("f400"),n("7f25"),n("536b"),n("d9ab"),n("f9ab"),n("32d7"),n("25c9"),n("9f3c"),n("042e"),n("c7c6"),n("f4ff"),n("049f"),n("7872"),n("a69f"),n("0b21"),n("6c1a"),n("c7c62"),n("84b4"),n("c5f6"),n("2e37"),n("fca0"),n("7cdf"),n("ee1d"),n("b1b1"),n("87f3"),n("9278"),n("5df2"),n("04ff"),n("f751"),n("8478"),n("4504"),n("fee7"),n("1c01"),n("58b2"),n("ffc1"),n("0d6d"),n("9986"),n("8e6e"),n("25db"),n("e4f7"),n("b9a1"),n("64d5"),n("9aea"),n("db97"),n("66c8"),n("57f0"),n("165b"),n("456d"),n("cf6a"),n("fd24"),n("8615"),n("551c"),n("097d"),n("df1b"),n("2397"),n("88ca"),n("ba16"),n("d185"),n("ebde"),n("2d34"),n("f6b3"),n("2251"),n("c698"),n("a19f"),n("9253"),n("9275"),n("3b2b"),n("3846"),n("4917"),n("a481"),n("28a5"),n("386d"),n("6b54"),n("4f7f"),n("8a81"),n("ac4d"),n("8449"),n("9c86"),n("fa83"),n("48c0"),n("a032"),n("aef6"),n("d263"),n("6c37"),n("9ec8"),n("5695"),n("2fdb"),n("d0b0"),n("5df3"),n("b54a"),n("f576"),n("ed50"),n("788d"),n("14b9"),n("f386"),n("f559"),n("1448"),n("673e"),n("242a"),n("4f37"),n("c66f"),n("262f"),n("b05c"),n("34ef"),n("6aa2"),n("15ac"),n("af56"),n("b6e4"),n("9c29"),n("63d9"),n("4dda"),n("10ad"),n("c02b"),n("4795"),n("130f"),n("ac6a"),n("96cf"),n("0cdd");var i=n("2b0e"),r=(n("be3b"),n("135e"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.message?n("div",{domProps:{textContent:t._s(t.message)}}):t.products?n("div",[n("Dialog",{ref:"dialog",attrs:{coupon:t.coupon,couponMatch:t.couponMatch,ordersURL:t.ordersURL,products:t.products,stripeKey:t.stripeKey,title:t.title},on:{coupon:t.onChangeCoupon}}),n("b-btn",{attrs:{variant:"primary"},domProps:{textContent:t._s(t.buttonLabel)},on:{click:t.onBuyTickets}}),t.priceLabel?n("span",{staticClass:"buy-tickets-price",domProps:{textContent:t._s(t.priceLabel)}}):t._e()],1):t._e()}),s=[],o=n("a34a"),a=n.n(o),u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-modal",{ref:"modal",attrs:{title:t.title,"no-close-on-backdrop":"","hide-footer":""},on:{shown:t.onShown,hide:t.onHide}},[t.orderID?n("Confirmation",{key:t.seq,attrs:{orderID:t.orderID},on:{close:t.onClose}}):n("OrderForm",{key:t.seq,ref:"form",attrs:{coupon:t.coupon,couponMatch:t.couponMatch,ordersURL:t.ordersURL,products:t.products,stripeKey:t.stripeKey},on:{coupon:t.onCouponChange,success:t.onOrderSuccess,cancel:t.onClose,submitting:t.onSubmitting}})],1)},c=[],l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._m(0),n("div",{attrs:{id:"connect-head"}},[t._v("Stay informed of Schola news!")]),n("div",[n("b-spinner",{directives:[{name:"show",rawName:"v-show",value:t.emailSpinner,expression:"emailSpinner"}],staticClass:"connect-done mt-1",attrs:{small:""}}),n("div",{directives:[{name:"show",rawName:"v-show",value:t.emailDone,expression:"emailDone"}],staticClass:"connect-done"},[t._v("✓")]),n("div",{staticClass:"connect-link",on:{click:t.onEmail}},[t._v("Subscribe to our email list")])],1),n("div",[n("div",{directives:[{name:"show",rawName:"v-show",value:t.facebookDone,expression:"facebookDone"}],staticClass:"connect-done"},[t._v("✓")]),n("div",{staticClass:"connect-link",on:{click:t.onFacebook}},[t._v("Follow us on Facebook")])]),n("div",[n("div",{directives:[{name:"show",rawName:"v-show",value:t.twitterDone,expression:"twitterDone"}],staticClass:"connect-done"},[t._v("✓")]),n("div",{staticClass:"connect-link",on:{click:t.onTwitter}},[t._v("Follow us on Twitter")])]),n("div",[n("b-btn",{attrs:{id:"connect-close",variant:"primary"},on:{click:function(e){return t.$emit("close")}}},[t._v("Close")])],1)])},d=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"ticket-confirm"}},[t._v("Thank you.  We have received your payment and emailed your\nticket. "),n("span",{attrs:{id:"ticket-reminder"}},[t._v("Please bring it with\nyou")]),t._v(" (printed or on phone) for admission.")])}];function p(t,e,n,i,r,s,o){try{var a=t[s](o),u=a.value}catch(c){return void n(c)}a.done?e(u):Promise.resolve(u).then(i,r)}function m(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var s=t.apply(e,n);function o(t){p(s,i,r,o,a,"next",t)}function a(t){p(s,i,r,o,a,"throw",t)}o(void 0)}))}}var f,h={props:{orderID:Number},data:function(){return{emailDone:!1,emailSpinner:!1,facebookDone:!1,twitterDone:!1}},methods:{onEmail:function(){var t=m(a.a.mark((function t(){var e;return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.emailDone){t.next=2;break}return t.abrupt("return");case 2:return this.emailSpinner=!0,t.next=5,this.$axios.post("/backend/email-signup?order=".concat(this.orderID)).catch((function(t){return console.error(t),null}));case 5:if(e=t.sent,this.emailSpinner=!1,e){t.next=9;break}return t.abrupt("return");case 9:e.status<400?this.emailDone=!0:console.error(e.statusText);case 10:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),onFacebook:function(){window.open("https://www.facebook.com/scholacantorum.org","_blank"),this.facebookDone=!0},onTwitter:function(){window.open("https://twitter.com/scholacantorum1","_blank"),this.twitterDone=!0}}},b=h,v=(n("6398"),n("2877")),y=Object(v["a"])(b,l,d,!1,null,null,null),g=y.exports,w=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-form",{attrs:{novalidate:""},on:{submit:function(e){return e.preventDefault(),t.onSubmit(e)}}},[n("OrderLines",{ref:"lines",attrs:{disabled:t.submitting,products:t.products,submitted:t.submitted},on:{lines:t.onLines}}),n("OrderDiscount",{ref:"discount",attrs:{coupon:t.coupon,couponMatch:t.couponMatch,disabled:t.submitting},on:{coupon:t.onCouponChange}}),n("OrderPayment",{ref:"pmt",attrs:{couponMatch:t.couponMatch,send:t.onSend,stripeKey:t.stripeKey,total:t.total},on:{cancel:t.onCancel,submitted:t.onSubmitted,submitting:t.onSubmitting}})],1)},k=[],_=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"buy-tickets-discount-row"}},[n("td",{attrs:{id:"buy-tickets-discount-label"}},[t._v("Discount code")]),n("b-form-input",{attrs:{id:"buy-tickets-discount-code",value:t.coupon,disabled:t.disabled,state:!1!==t.couponMatch&&null},on:{change:function(e){t.$emit("coupon",e.toUpperCase())}}})],1)},C=[],x={props:{coupon:String,couponMatch:Boolean,disabled:Boolean}},P=x,S=(n("9c02"),Object(v["a"])(P,_,C,!1,null,null,null)),$=S.exports,q=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-container",{staticClass:"px-0 mb-3",attrs:{fluid:""}},[n("b-form-group",{staticClass:"mb-0",attrs:{label:"Ticket Quantities","label-sr-only":"",state:t.state,"invalid-feedback":"How many tickets do you want?"}},[n("table",{attrs:{id:"buy-tickets-form-quantities"}},t._l(t.products,(function(e){return n("OrderLinesQty",{key:e.id,ref:"qty",refInFor:!0,attrs:{name:e.name,subname:e.subname,message:e.message,price:e.price,state:t.state,disabled:t.disabled},model:{value:t.quantities[e.id],callback:function(n){t.$set(t.quantities,e.id,n)},expression:"quantities[p.id]"}})})),1)]),n("OrderLinesDonation",{attrs:{disabled:t.disabled},model:{value:t.donation,callback:function(e){t.donation=e},expression:"donation"}}),n("OrderLinesTotal",{attrs:{total:t.total}})],1)},O=[],L=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"buy-tickets-donation-row"}},[n("div",{attrs:{id:"buy-tickets-donation-label"}},[t._v("Add a donation to your order?")]),n("div",{attrs:{id:"buy-tickets-donation-amount-cell"}},[t._v("$\n"),n("b-form-input",{attrs:{id:"buy-tickets-donation-amount",value:t.value||"",disabled:t.disabled,type:"number",placeholder:"0",min:"0"},on:{input:function(e){t.$emit("input",Math.max(parseInt(e)||0),0)},focus:function(t){return t.target.select()}}})],1)])},R=[],M={props:{disabled:Boolean,value:Number}},D=M,E=(n("bb3d"),Object(v["a"])(D,L,R,!1,null,null,null)),T=E.exports,j=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("tr",{staticClass:"buy-tickets-qty-row"},[t.message?[n("td",{staticClass:"buy-tickets-qty-row-names"},[n("div",{staticClass:"buy-tickets-qty-row-name",domProps:{innerHTML:t._s(t.name)}}),t.subname?n("div",{staticClass:"buy-tickets-qty-row-subname",domProps:{innerHTML:t._s(t.subname)}}):t._e()]),t.message?n("td",{staticClass:"buy-tickets-qty-row-message",attrs:{colspan:"4"},domProps:{textContent:t._s(t.message)}}):t._e()]:[n("td",{staticClass:"buy-tickets-qty-row-names",attrs:{colspan:"2"}},[n("div",{staticClass:"buy-tickets-qty-row-name",domProps:{innerHTML:t._s(t.name)}}),t.subname?n("div",{staticClass:"buy-tickets-qty-row-subname",domProps:{innerHTML:t._s(t.subname)}}):t._e()]),n("td",{staticClass:"buy-tickets-qty-row-qty-cell"},[n("b-form-input",{ref:"input",staticClass:"buy-tickets-qty-row-qty",attrs:{value:t.value||"",state:t.state,disabled:t.disabled,type:"number",placeholder:"0",min:"0"},on:{input:function(e){t.$emit("input",Math.max(parseInt(e)||0),0)},focus:function(t){return t.target.select()}}})],1),n("td",{staticClass:"buy-tickets-qty-row-price"},[t._v("×$"+t._s(t.price/100))]),n("td",{staticClass:"buy-tickets-qty-row-amount",domProps:{textContent:t._s(t.value?"$"+t.price*t.value/100:"")}})]],2)},B=[],A={props:{autofocus:Boolean,disabled:Boolean,message:String,name:String,subname:String,price:Number,state:Boolean,value:Number},methods:{focus:function(){this.$refs.input.focus()}}},F=A,N=(n("6f3f"),Object(v["a"])(F,j,B,!1,null,null,null)),I=N.exports,U=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"buy-tickets-form-total-row"}},[n("div",{attrs:{id:"buy-tickets-form-total"},domProps:{textContent:t._s("$"+t.total/100)}})])},K=[],z={props:{total:Number}},H=z,Z=(n("42f5"),Object(v["a"])(H,U,K,!1,null,null,null)),Q=Z.exports,J={components:{OrderLinesDonation:T,OrderLinesQty:I,OrderLinesTotal:Q},props:{disabled:Boolean,products:Array,submitted:Boolean},data:function(){return{donation:0,quantities:{}}},watch:{donation:"emitLines",hasOne:"emitLines",products:{immediate:!0,handler:"fillQuantities"},quantities:{deep:!0,handler:"emitLines"}},computed:{hasOne:function(){var t=this;return this.products.some((function(e){return!e.message&&t.quantities[e.id]}))},state:function(){return!(this.submitted&&!this.hasOne)&&null},total:function(){var t=this;return this.products.reduce((function(e,n){return e+(n.message?0:n.price*t.quantities[n.id]||0)}),0)+100*this.donation}},methods:{emitLines:function(){var t=this;if(this.products&&this.hasOne){var e=[];this.products.forEach((function(n){n.message||e.push({product:n.id,price:n.price,quantity:t.quantities[n.id]||0})})),this.donation&&e.push({product:"donation",price:100*this.donation,quantity:1}),this.$emit("lines",e)}else this.$emit("lines",null)},fillQuantities:function(){var t=this;if(this.products){var e,n=0,i=!1;this.products.forEach((function(r){t.quantities[r.id]||t.$set(t.quantities,r.id,0),t.quantities[r.id]&&(i=!0),r.message||(n++,e=r.id)})),i||1!==n||(this.quantities[e]=1),this.emitLines()}},focus:function(){this.$refs.qty[0].focus()}}},W=J,Y=(n("1e9b"),Object(v["a"])(W,q,O,!1,null,null,null)),G=Y.exports,V=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:null!==t.canPR,expression:"canPR !== null"}],attrs:{id:"buy-tickets-form-payment"}},[t.canPR?n("div",{attrs:{id:"buy-tickets-form-use-pr-div"}},[n("label",{attrs:{id:"buy-tickets-form-use-pr-label",for:"buy-tickets-form-use-pr"}},[t._v("Use payment info saved "+t._s(t.deviceOrBrowser)+"?")]),n("b-form-checkbox",{attrs:{id:"buy-tickets-form-use-pr",switch:""},model:{value:t.usePR,callback:function(e){t.usePR=e},expression:"usePR"}})],1):t._e(),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.usePR,expression:"!usePR"}]},[n("b-form-group",{staticClass:"mb-1",attrs:{label:"Your name","label-sr-only":"",state:t.nameState,"invalid-feedback":"Please enter your name."}},[n("b-form-input",{attrs:{placeholder:"Your name",autocomplete:"name",disabled:t.submitting},model:{value:t.name,callback:function(e){t.name="string"===typeof e?e.trim():e},expression:"name"}})],1),n("b-form-group",{staticClass:"mb-1",attrs:{label:"Email address","label-sr-only":"",state:t.emailState,"invalid-feedback":t.email?"This is not a valid email address.":"Please enter your email address."}},[n("b-form-input",{attrs:{type:"email",placeholder:"Email address",autocomplete:"email",disabled:t.submitting},on:{focus:function(e){t.emailFocused=!0},blur:function(e){t.emailFocused=!1}},model:{value:t.email,callback:function(e){t.email="string"===typeof e?e.trim():e},expression:"email"}})],1),n("b-form-group",{staticClass:"mb-1",attrs:{label:"Card number","label-sr-only":"",state:!t.cardError&&null,"invalid-feedback":t.cardError}},[n("div",{ref:"card",staticClass:"form-control",attrs:{id:"buy-tickets-form-card"}})])],1),n("div",{attrs:{id:"buy-tickets-form-footer"}},[t.message?n("div",{attrs:{id:"buy-tickets-form-message"},domProps:{textContent:t._s(t.message)}}):t._e(),n("div",{attrs:{id:"buy-tickets-form-buttons"}},[n("b-btn",{attrs:{type:"button",variant:"secondary",disabled:t.submitting},on:{click:t.onCancel}},[t._v("Cancel")]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.usePR,expression:"usePR"}],ref:"prbutton",attrs:{id:"buy-tickets-form-prbutton"}}),!t.usePR&&t.submitting?n("b-btn",{attrs:{id:"buy-tickets-form-pay-now",type:"submit",variant:"primary",disabled:""}},[n("b-spinner",{staticClass:"mr-1",attrs:{small:""}}),t._v("Paying...")],1):t._e(),t.usePR||t.submitting?t._e():n("b-btn",{attrs:{id:"buy-tickets-form-pay-now",type:"submit",variant:"primary"}},[t._v("Pay "+t._s(t.total?"$"+t.total/100:"Now"))])],1)])])},X=[];function tt(t,e,n,i,r,s,o){try{var a=t[s](o),u=a.value}catch(c){return void n(c)}a.done?e(u):Promise.resolve(u).then(i,r)}function et(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var s=t.apply(e,n);function o(t){tt(s,i,r,o,a,"next",t)}function a(t){tt(s,i,r,o,a,"throw",t)}o(void 0)}))}}var nt={props:{couponMatch:Boolean,send:Function,stripeKey:String,total:Number},data:function(){return{canPR:null,card:null,cardChange:null,cardFocus:!1,elements:null,email:"",emailFocused:!1,message:null,name:"",payreq:null,prbutton:null,submitted:!1,submitting:!1,usePR:!1}},mounted:function(){var t=et(a.a.mark((function t(){var e=this;return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return f||(f=Stripe(this.stripeKey)),this.elements=f.elements(),this.card=this.elements.create("card",{style:{base:{fontSize:"16px",lineHeight:1.5}}}),this.card.on("change",this.onCardChange),this.card.on("focus",(function(){e.cardFocus=!0})),this.card.on("blur",(function(){e.cardFocus=!1})),this.$nextTick((function(){e.card.mount(e.$refs.card)})),this.payreq=f.paymentRequest({country:"US",currency:"usd",total:{label:"Schola Cantorum Ticket Order",amount:100,pending:!0},requestPayerName:!0,requestPayerEmail:!0}),t.next=10,this.payreq.canMakePayment();case 10:this.canPR=!!t.sent,this.canPR&&(this.usePR=!0,this.payreq.on("paymentmethod",this.onPaymentMethod),this.prbutton=this.elements.create("paymentRequestButton",{paymentRequest:this.payreq}),this.prbutton.on("click",this.onPRButtonClick),this.$nextTick((function(){e.prbutton.mount(e.$refs.prbutton)})));case 12:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),computed:{cardError:function(){return this.cardChange&&this.cardChange.error?this.cardChange.error.message:this.submitted?!this.cardChange||this.cardChange.empty?"Please enter your card number.":this.cardFocus||this.cardChange.complete?null:"This card number is incomplete.":null},deviceOrBrowser:function(){var t=navigator.userAgent||navigator.vendor;return/android|ipad|iphone|ipod|windows phone/i.test(t)?"on device":"in browser"},emailState:function(){return!(!this.emailFocused&&this.email&&!this.email.match(/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/))&&(!(this.submitted&&!this.email)&&null)},nameState:function(){return(!this.submitted||""!=this.name)&&null}},watch:{submitted:function(){this.submitted&&this.$emit("submitted")},submitting:function(){this.$emit("submitting",this.submitting)},usePR:function(){this.submitted=!1}},methods:{onCancel:function(){this.$emit("cancel")},onCardChange:function(t){this.cardChange=t},onPaymentMethod:function(){var t=et(a.a.mark((function t(e){var n;return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.submitting=!0,this.card.update({disabled:!0}),t.next=4,this.send({name:e.payerName,email:e.payerEmail,subtype:"API ".concat(e.methodName),method:e.paymentMethod.id});case 4:n=t.sent,this.submitting=!1,this.card.update({disabled:!1}),n&&(this.message=n),e.complete(n?"fail":"success");case 9:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),onPRButtonClick:function(t){this.submitted=!0,this.message=null,null!==this.total&&this.couponMatch?this.payreq.update({total:{label:"Schola Cantorum Ticket Order",amount:this.total,pending:!1}}):t.preventDefault()},submit:function(){var t=et(a.a.mark((function t(){var e,n,i,r;return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(null!==this.canPR&&!this.usePR){t.next=2;break}return t.abrupt("return");case 2:if(this.submitted=!0,this.message=null,null!==this.total&&null===this.nameState&&null===this.emailState&&!this.cardError&&this.couponMatch){t.next=6;break}return t.abrupt("return");case 6:return this.submitting=!0,this.card.update({disabled:!0}),t.next=10,f.createPaymentMethod("card",this.card,{billing_details:{name:this.name,email:this.email}});case 10:if(e=t.sent,n=e.paymentMethod,i=e.error,!i){t.next=19;break}return console.error(i),this.submitting=!1,this.card.update({disabled:!1}),"card_error"===i.type||"validation_error"===i.type?this.message=i.message:this.message="We’re sorry, but we're unable to process payment cards at the moment.  Please try again later, or call our office at (650) 254-1700 to order by phone.",t.abrupt("return");case 19:return t.next=21,this.send({name:this.name,email:this.email,subtype:"manual",method:n.id});case 21:r=t.sent,this.submitting=!1,this.card.update({disabled:!1}),r&&(this.message=r);case 25:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},it=nt,rt=(n("905a"),Object(v["a"])(it,V,X,!1,null,null,null)),st=rt.exports;function ot(t,e,n,i,r,s,o){try{var a=t[s](o),u=a.value}catch(c){return void n(c)}a.done?e(u):Promise.resolve(u).then(i,r)}function at(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var s=t.apply(e,n);function o(t){ot(s,i,r,o,a,"next",t)}function a(t){ot(s,i,r,o,a,"throw",t)}o(void 0)}))}}var ut={components:{OrderDiscount:$,OrderLines:G,OrderPayment:st},props:{coupon:String,couponMatch:Boolean,ordersURL:String,products:Array,stripeKey:String},data:function(){return{lines:null,submitted:!1,submitting:!1}},computed:{total:function(){return this.lines?this.lines.reduce((function(t,e){return t+e.quantity*(e.price||0)}),0):null}},watch:{submitting:function(){this.$emit("submitting",this.submitting)}},methods:{onCancel:function(){this.$emit("cancel")},onCouponChange:function(t){this.$emit("coupon",t)},onLines:function(t){this.lines=t},onSubmit:function(){this.$refs.pmt.submit()},onSubmitted:function(){this.submitted=!0},onSubmitting:function(t){this.submitting=t},onSend:function(){var t=at(a.a.mark((function t(e){var n,i,r,s,o;return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.name,i=e.email,r=e.subtype,s=e.method,t.next=3,this.$axios.post("".concat(this.ordersURL,"/api/order"),JSON.stringify({source:"public",name:n,email:i,coupon:this.coupon,lines:this.lines.filter((function(t){return t.quantity&&!t.message})).map((function(t){return{product:t.product,quantity:t.quantity,price:t.price}})),payments:[{type:"card",subtype:r,method:s,amount:this.total}]}),{headers:{"Content-Type":"application/json"}}).catch((function(t){return t}));case 3:if(o=t.sent,!(o&&o.data&&o.data.id)){t.next=7;break}return this.$emit("success",o.data.id),t.abrupt("return",null);case 7:if(!(o&&o.data&&o.data.error)){t.next=9;break}return t.abrupt("return",o.data.error);case 9:return console.error(o),t.abrupt("return","We’re sorry, but we're unable to process payment cards at the moment.  Please try again later, or call our office at (650) 254-1700 to order by phone.");case 11:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),setAutoFocus:function(){this.$refs.lines.focus()}}},ct=ut,lt=(n("23c60"),Object(v["a"])(ct,w,k,!1,null,null,null)),dt=lt.exports,pt={components:{Confirmation:g,OrderForm:dt},props:{coupon:String,couponMatch:Boolean,ordersURL:String,products:Array,stripeKey:String,title:String},data:function(){return{orderID:null,seq:0,submitting:!1}},methods:{onClose:function(){this.$refs.modal.hide()},onCouponChange:function(t){this.$emit("coupon",t)},onHide:function(t){this.submitting&&t.preventDefault()},onOrderSuccess:function(t){this.orderID=t,this.submitting=!1},onShown:function(){this.$refs.form.setAutoFocus()},onSubmitting:function(t){this.submitting=t},show:function(){this.seq++,this.orderID=null,this.$refs.modal.show()}}},mt=pt,ft=Object(v["a"])(mt,u,c,!1,null,null,null),ht=ft.exports;function bt(t){return bt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bt(t)}function vt(t,e,n,i,r,s,o){try{var a=t[s](o),u=a.value}catch(c){return void n(c)}a.done?e(u):Promise.resolve(u).then(i,r)}function yt(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var s=t.apply(e,n);function o(t){vt(s,i,r,o,a,"next",t)}function a(t){vt(s,i,r,o,a,"throw",t)}o(void 0)}))}}var gt={props:{ordersURL:String,productIDs:Array,stripeKey:String,title:String},components:{Dialog:ht},data:function(){return{coupon:"",couponMatch:null,message:null,products:null}},mounted:function(){this.getPrices()},computed:{buttonLabel:function(){return this.title.includes("Subscription")?"Buy Subscriptions":"Buy Tickets"},priceLabel:function(){var t=this;return this.products&&this.products.length&&this.products[0].price?this.products.some((function(e){return e.price!==t.products[0].price}))?null:"$".concat(this.products[0].price/100," each"):null}},methods:{getPrices:function(){var t=yt(a.a.mark((function t(){var e,n;return a.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.couponMatch=null,e=new URLSearchParams,this.productIDs.forEach((function(t){e.append("p",t)})),e.append("coupon",this.coupon),t.prev=4,t.next=7,this.$axios({method:"GET",url:"".concat(this.ordersURL,"/api/prices"),params:e});case 7:n=t.sent.data,t.next=15;break;case 10:return t.prev=10,t.t0=t["catch"](4),console.error(t.t0),this.couponMatch=""===this.coupon,t.abrupt("return");case 15:this.message="string"===typeof n?n:null,this.products="object"===bt(n)?n.products:null,this.couponMatch="object"===bt(n)?n.coupon:""===this.coupon,this.products&&this.products.forEach((function(t){if(t.name&&t.name.indexOf("\n")>0){var e=t.name.split("\n");t.name=e[0],t.subname=e[1]}}));case 19:case"end":return t.stop()}}),t,this,[[4,10]])})));function e(){return t.apply(this,arguments)}return e}(),onBuyTickets:function(){this.$refs.dialog.show()},onChangeCoupon:function(t){this.coupon=t,this.getPrices()}}},wt=gt,kt=(n("16bc"),Object(v["a"])(wt,r,s,!1,null,null,null)),_t=kt.exports;i["default"].config.productionTip=!1,window.addEventListener("load",(function(){var t=document.getElementsByClassName("buy-tickets"),e=function(){var e=t[0],n=e.getAttribute("data-products").split(" ");new i["default"]({render:function(t){return t(_t,{props:{ordersURL:e.getAttribute("data-orders-url"),productIDs:n,stripeKey:e.getAttribute("data-stripe-key"),title:e.getAttribute("data-title")}})}}).$mount(e)};while(t.length)e()}))},afa0:function(t,e,n){},bb3d:function(t,e,n){"use strict";var i=n("7534"),r=n.n(i);r.a},be3b:function(t,e,n){"use strict";var i=n("2b0e"),r=n("bc3a"),s=n.n(r),o={},a=s.a.create(o);a.interceptors.request.use((function(t){return t}),(function(t){return Promise.reject(t)})),a.interceptors.response.use((function(t){return t}),(function(t){return Promise.reject(t)})),Plugin.install=function(t){t.axios=a,window.axios=a,Object.defineProperties(t.prototype,{axios:{get:function(){return a}},$axios:{get:function(){return a}}})},i["default"].use(Plugin);Plugin},d635:function(t,e,n){},f7ff:function(t,e,n){},fcfa:function(t,e,n){},ff6d:function(t,e,n){}});
//# sourceMappingURL=buy-tickets.b1806d8b.js.map