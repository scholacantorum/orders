(function(t){function e(e){for(var r,o,i=e[0],c=e[1],u=e[2],d=0,p=[];d<i.length;d++)o=i[d],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&p.push(s[o][0]),s[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);l&&l(e);while(p.length)p.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],r=!0,i=1;i<n.length;i++){var c=n[i];0!==s[c]&&(r=!1)}r&&(a.splice(e--,1),t=o(o.s=n[0]))}return t}var r={},s={app:0},a=[];function o(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var u=0;u<i.length;u++)e(i[u]);var l=c;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"19af":function(t,e,n){},"1abd":function(t,e,n){},"1e19":function(t,e,n){},2285:function(t,e,n){"use strict";var r=n("580c"),s=n.n(r);s.a},2906:function(t,e,n){"use strict";var r=n("f13f"),s=n.n(r);s.a},"3ab8":function(t,e,n){},4767:function(t,e,n){"use strict";var r=n("3ab8"),s=n.n(r);s.a},"54ee":function(t,e,n){},5666:function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("744f"),n("6c7b"),n("7514"),n("20d6"),n("1c4c"),n("6762"),n("cadf"),n("e804"),n("55dd"),n("d04f"),n("c8ce"),n("217b"),n("7f7f"),n("f400"),n("7f25"),n("536b"),n("d9ab"),n("f9ab"),n("32d7"),n("25c9"),n("9f3c"),n("042e"),n("c7c6"),n("f4ff"),n("049f"),n("7872"),n("a69f"),n("0b21"),n("6c1a"),n("c7c62"),n("84b4"),n("c5f6"),n("2e37"),n("fca0"),n("7cdf"),n("ee1d"),n("b1b1"),n("87f3"),n("9278"),n("5df2"),n("04ff"),n("f751"),n("4504"),n("fee7"),n("ffc1"),n("0d6d"),n("9986"),n("8e6e"),n("25db"),n("e4f7"),n("b9a1"),n("64d5"),n("9aea"),n("db97"),n("66c8"),n("57f0"),n("165b"),n("456d"),n("cf6a"),n("fd24"),n("8615"),n("551c"),n("097d"),n("df1b"),n("2397"),n("88ca"),n("ba16"),n("d185"),n("ebde"),n("2d34"),n("f6b3"),n("2251"),n("c698"),n("a19f"),n("9253"),n("9275"),n("3b2b"),n("3846"),n("4917"),n("a481"),n("28a5"),n("386d"),n("6b54"),n("4f7f"),n("8a81"),n("ac4d"),n("8449"),n("9c86"),n("fa83"),n("48c0"),n("a032"),n("aef6"),n("d263"),n("6c37"),n("9ec8"),n("5695"),n("2fdb"),n("d0b0"),n("5df3"),n("b54a"),n("f576"),n("ed50"),n("788d"),n("14b9"),n("f386"),n("f559"),n("1448"),n("673e"),n("242a"),n("c66f"),n("b05c"),n("34ef"),n("6aa2"),n("15ac"),n("af56"),n("b6e4"),n("9c29"),n("63d9"),n("4dda"),n("10ad"),n("c02b"),n("4795"),n("130f"),n("ac6a"),n("96cf"),n("0cdd");var r=n("2b0e"),s=n("bc3a"),a=n.n(s),o={},i=a.a.create(o);i.interceptors.request.use((function(t){return t}),(function(t){return Promise.reject(t)})),i.interceptors.response.use((function(t){return t}),(function(t){return Promise.reject(t)})),Plugin.install=function(t){t.axios=i,window.axios=i,Object.defineProperties(t.prototype,{axios:{get:function(){return i}},$axios:{get:function(){return i}}})},r["default"].use(Plugin);Plugin;var c=n("5f5b");n("ab8b"),n("2dd8");r["default"].use(c["a"]);var u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[t._m(0),n("div",{attrs:{id:"app-body"}},[t.$store.state.auth?t.$store.state.event?n("Main"):n("ChooseEvent"):n("Login")],1)])},l=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"app-header"}},[r("img",{attrs:{id:"app-header-logo",src:n("8fd5")}}),r("div",{attrs:{id:"app-header-title"}},[t._v("Schola at the Door")])])}],d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"event"}},[n("div",{attrs:{id:"event-heading"}},[t._v("Choose Event")]),t.choosing||!t.events?n("b-spinner",{attrs:{id:"event-spinner"}}):t._l(t.events,(function(e){return n("div",{key:e.id,staticClass:"event-tile",domProps:{textContent:t._s(e.start.substr(0,10)+" "+e.name)},on:{click:function(n){return t.onClick(e)}}})}))],2)},p=[],h=n("a34a"),f=n.n(h);function m(t,e,n,r,s,a,o){try{var i=t[a](o),c=i.value}catch(u){return void n(u)}i.done?e(c):Promise.resolve(c).then(r,s)}function v(t){return function(){var e=this,n=arguments;return new Promise((function(r,s){var a=t.apply(e,n);function o(t){m(a,r,s,o,i,"next",t)}function i(t){m(a,r,s,o,i,"throw",t)}o(void 0)}))}}var b={data:function(){return{events:null,choosing:!1}},mounted:function(){var t=v(f.a.mark((function t(){return f.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$axios.get("/api/event?future=1&freeEntries=1",{headers:{Auth:this.$store.state.auth}});case 3:this.events=t.sent.data,t.next=10;break;case 6:t.prev=6,t.t0=t["catch"](0),console.error("Error getting event list",t.t0),window.alert("Server error: ".concat(t.t0.toString()));case 10:case"end":return t.stop()}}),t,this,[[0,6]])})));function e(){return t.apply(this,arguments)}return e}(),methods:{onClick:function(){var t=v(f.a.mark((function t(e){var n;return f.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.choosing=!0,t.next=4,this.$axios.get("/api/prices",{headers:{Auth:this.$store.state.auth},params:{event:e.id,source:"inperson"}});case 4:if(t.t0=function(t){return!t.message},n=t.sent.data.products.filter(t.t0),this.choosing=!1,n.length){t.next=10;break}return window.alert("No tickets are on sale for that event."),t.abrupt("return");case 10:this.$store.commit("event",{event:e,products:n}),t.next=18;break;case 13:t.prev=13,t.t1=t["catch"](0),this.choosing=!1,console.error("Error getting event products",t.t1),window.alert("Server error: ".concat(t.t1.toString()));case 18:case"end":return t.stop()}}),t,this,[[0,13]])})));function e(e){return t.apply(this,arguments)}return e}()}},y=b,g=(n("9c64"),n("2877")),w=Object(g["a"])(y,d,p,!1,null,null,null),C=w.exports,k=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",{attrs:{id:"login"},on:{submit:function(e){return e.preventDefault(),t.onSubmit(e)}}},[n("div",{attrs:{id:"login-header"}},[t._v("Please log in.")]),n("b-form-group",{attrs:{label:"Username","label-for":"login-username","label-cols":"4"}},[n("b-form-input",{attrs:{id:"login-username",autocapitalize:"none",autocomplete:"username",autofocus:"",trim:""},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}})],1),n("b-form-group",{attrs:{label:"Password","label-for":"login-password","label-cols":"4"}},[n("b-form-input",{attrs:{id:"login-password",type:"password",autocomplete:"password"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),n("b-form-group",{attrs:{id:"login-allow-row",label:"Allow","label-cols":"4"}},[n("b-form-checkbox-group",{attrs:{options:t.possiblePrivs,stacked:"",switches:""},model:{value:t.privs,callback:function(e){t.privs=e},expression:"privs"}})],1),t.error?n("div",{attrs:{id:"login-error"},domProps:{textContent:t._s(t.error)}}):t._e(),n("b-button",{attrs:{id:"login-button",type:"submit",variant:"primary",disabled:t.disabled},domProps:{textContent:t._s(t.buttonText)}})],1)},x=[];function S(t,e,n,r,s,a,o){try{var i=t[a](o),c=i.value}catch(u){return void n(u)}i.done?e(c):Promise.resolve(c).then(r,s)}function P(t){return function(){var e=this,n=arguments;return new Promise((function(r,s){var a=t.apply(e,n);function o(t){S(a,r,s,o,i,"next",t)}function i(t){S(a,r,s,o,i,"throw",t)}o(void 0)}))}}var $={data:function(){return{error:null,loggingIn:!1,password:null,possiblePrivs:[{value:"card",text:"Credit/debit card sales"},{value:"cash",text:"Cash/check sales"},{value:"willcall",text:"Will call"}],privs:["card","cash","willcall"],username:null}},computed:{buttonText:function(){return this.loggingIn?"Logging in...":"Login"},disabled:function(){return this.loggingIn||!this.password||!this.username||!this.privs.length}},methods:{onSubmit:function(){var t=P(f.a.mark((function t(){var e,n,r;return f.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=new URLSearchParams,e.append("username",this.username),e.append("password",this.password),this.loggingIn=!0,t.prev=4,t.next=7,this.$axios.post("/api/login",e);case 7:if(n=t.sent.data,this.loggingIn=!1,n.privScanTickets){t.next=12;break}return this.error="Not authorized to use this app",t.abrupt("return");case 12:if(r={},this.privs.forEach((function(t){r[t]=!0})),!r.card&&!r.cash||n.privInPersonSales){t.next=17;break}return this.error="Not authorized to sell tickets",t.abrupt("return");case 17:if(!r.willcall||n.privViewOrders){t.next=20;break}return this.error="Not authorized to view will call list",t.abrupt("return");case 20:this.$store.commit("login",{auth:n.token,allow:r,stripeKey:n.stripePublicKey,username:this.username}),t.next=32;break;case 23:if(t.prev=23,t.t0=t["catch"](4),this.loggingIn=!1,!t.t0.response||401!==t.t0.response.status){t.next=29;break}return this.error="Login incorrect",t.abrupt("return");case 29:return console.error("Error logging in",t.t0),this.error="Server error — login failed",t.abrupt("return");case 32:case"end":return t.stop()}}),t,this,[[4,23]])})));function e(){return t.apply(this,arguments)}return e}()}},_=$,A=(n("b543"),Object(g["a"])(_,k,x,!1,null,null,null)),O=A.exports,E=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"main"}},[n("div",{attrs:{id:"main-header"},domProps:{textContent:t._s(t.eventHeader)}}),n("div",{attrs:{id:"main-body"}},["sell"===t.mode?n("SellTickets",{on:{done:t.onMenu}}):"willcall"===t.mode?n("WillCall",{on:{done:t.onMenu}}):"scan"===t.mode?n("ScanTickets",{on:{done:t.onMenu}}):n("div",{attrs:{id:"main-menu"}},[t.canSellTickets?n("b-button",{staticClass:"main-button",attrs:{variant:"primary"},on:{click:t.onSellTickets}},[t._v("Sell Tickets")]):t._e(),t.canWillCall?n("b-button",{staticClass:"main-button",attrs:{variant:"primary"},on:{click:t.onWillCall}},[t._v("Will Call")]):t._e(),n("b-button",{staticClass:"main-button",attrs:{variant:"primary"},on:{click:t.onScanTickets}},[t._v("Scan Tickets")]),n("b-button",{attrs:{id:"main-logout"},on:{click:t.onLogout}},[t._v("Logout")]),n("div",{attrs:{id:"main-stats"},domProps:{textContent:t._s(t.stats)}})],1)],1)])},j=[],T=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.selected?n("UseTickets",{attrs:{orderID:t.selected},on:{cancel:t.onUseDone,done:t.onUseDone}}):n("div",{attrs:{id:"scan"}},[t.error?n("div",{attrs:{id:"scan-error"},domProps:{textContent:t._s(t.error)}}):n("QrcodeStream",{attrs:{id:"scan-stream",track:!1},on:{init:t.onStreamInit,decode:t.onDecode}}),n("form",{attrs:{id:"scan-form"},on:{submit:function(e){return e.preventDefault(),t.onSubmit(e)}}},[n("b-form-input",{attrs:{id:"scan-oid",autocomplete:"off",formatter:t.oidFormatter,inputmode:"numeric",pattern:"[0-9]*",placeholder:"Order #"},model:{value:t.orderID,callback:function(e){t.orderID=e},expression:"orderID"}}),n("b-button",{attrs:{id:"scan-button",type:"submit",variant:t.buttonVariant},domProps:{textContent:t._s(t.buttonLabel)}})],1)],1)},D=[],q=n("9a3e"),U=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.order?n("div",{attrs:{id:"use"}},[n("div",{attrs:{id:"use-order"}},[n("div",{attrs:{id:"use-order-name"},domProps:{textContent:t._s(t.order.name)}}),n("div",{attrs:{id:"use-order-num"},domProps:{textContent:t._s("Order #"+t.order.id)}})]),n("div",{attrs:{id:"use-classes"}},t._l(t.order.classes,(function(e){return n("UseTicketClass",{key:e.name,attrs:{tclass:e},on:{change:t.onClassChange}})})),1),n("div",{attrs:{id:"use-buttons"}},[n("b-button",{staticClass:"use-button",attrs:{disabled:t.disabled,variant:"primary"},domProps:{textContent:t._s(t.buttonText)},on:{click:t.onUseTickets}}),n("b-button",{staticClass:"use-button",on:{click:function(e){return t.$emit("cancel")}}},[t._v("Cancel")])],1)]):n("div",{attrs:{id:"use-spinner"}},[n("b-spinner")],1)},L=[],N=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"useclass",class:t.classes},[n("div",{staticClass:"useclass-inner"},[n("div",{staticClass:"useclass-name",domProps:{textContent:t._s(t.tclass.name||"General Admission")}}),n("div",{staticClass:"useclass-buttons"},t._l(t.max,(function(e){return n("b-button",{key:e,staticClass:"useclass-button",attrs:{disabled:t.disabled(e),variant:t.variant(e)},domProps:{textContent:t._s(t.buttonText(e))},on:{click:function(n){return t.onClick(e)}}})})),1)])])},Z=[],z={props:{tclass:Object},computed:{classes:function(){return this.tclass.overflow?"useclass-overflow":this.tclass.name?"useclass-restricted":null},max:function(){return this.tclass.max<1e3?this.tclass.max:6*Math.ceil((this.tclass.used+1)/6)}},methods:{buttonText:function(t){return t<=this.tclass.min?"Used":t-this.tclass.min},disabled:function(t){return t<this.tclass.min},onClick:function(t){t<this.tclass.min||(1===t&&0===this.tclass.min&&1===this.tclass.used?this.$emit("change",{tclass:this.tclass,used:0}):this.$emit("change",{tclass:this.tclass,used:t}))},variant:function(t){return t<=this.tclass.min?"dark":t<=this.tclass.used?"success":"outline-success"}}},I=z,J=(n("f756"),Object(g["a"])(I,N,Z,!1,null,null,null)),M=J.exports;function Q(t,e,n,r,s,a,o){try{var i=t[a](o),c=i.value}catch(u){return void n(u)}i.done?e(c):Promise.resolve(c).then(r,s)}function R(t){return function(){var e=this,n=arguments;return new Promise((function(r,s){var a=t.apply(e,n);function o(t){Q(a,r,s,o,i,"next",t)}function i(t){Q(a,r,s,o,i,"throw",t)}o(void 0)}))}}var K={components:{UseTicketClass:M},props:{orderID:String},data:function(){return{order:null,using:!1}},mounted:function(){var t=R(f.a.mark((function t(){var e;return f.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$axios.get("/api/event/".concat(this.$store.state.event.id,"/ticket/").concat(this.orderID),{headers:{Auth:this.$store.state.auth}});case 3:if(e=t.sent.data,!e.error){t.next=8;break}return window.alert(e.error),this.$emit("cancel"),t.abrupt("return");case 8:this.order=e,t.next=19;break;case 11:if(t.prev=11,t.t0=t["catch"](0),!t.t0.response||401!==t.t0.response.status){t.next=17;break}return this.$store.commit("logout"),window.alert("Login session expired"),t.abrupt("return");case 17:console.error("Error fetching ticket usage",t.t0),window.alert("Server error: ".concat(t.t0.toString()));case 19:case"end":return t.stop()}}),t,this,[[0,11]])})));function e(){return t.apply(this,arguments)}return e}(),computed:{buttonText:function(){return this.using?"Using...":"Use Tickets"},disabled:function(){return this.using||this.order.classes.every((function(t){return t.min===t.used}))}},methods:{onClassChange:function(t){var e=t.tclass,n=t.used;e.used=n,e.overflow=!1},onUseTickets:function(){var t=R(f.a.mark((function t(){var e;return f.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.using=!0,e=new URLSearchParams,e.append("scan",this.order.scan),this.order.classes.forEach((function(t){e.append("class",t.name),e.append("used",t.used)})),t.next=7,this.$axios.post("/api/event/".concat(this.$store.state.event.id,"/ticket/").concat(this.order.id),e,{headers:{Auth:this.$store.state.auth}});case 7:this.$store.commit("admitted",this.order.classes.reduce((function(t,e){return e.used-e.min}),0)),this.$emit("done"),t.next=20;break;case 11:if(t.prev=11,t.t0=t["catch"](0),!t.t0.response||401!==t.t0.response.status){t.next=17;break}return this.$store.commit("logout"),window.alert("Login session expired"),t.abrupt("return");case 17:this.using=!1,console.error("Error updating ticket usage",t.t0),window.alert("Server error: ".concat(t.t0.toString()));case 20:case"end":return t.stop()}}),t,this,[[0,11]])})));function e(){return t.apply(this,arguments)}return e}()}},B=K,W=(n("4767"),Object(g["a"])(B,U,L,!1,null,null,null)),F=W.exports;function G(t,e,n,r,s,a,o){try{var i=t[a](o),c=i.value}catch(u){return void n(u)}i.done?e(c):Promise.resolve(c).then(r,s)}function V(t){return function(){var e=this,n=arguments;return new Promise((function(r,s){var a=t.apply(e,n);function o(t){G(a,r,s,o,i,"next",t)}function i(t){G(a,r,s,o,i,"throw",t)}o(void 0)}))}}var H,Y={components:{QrcodeStream:q["QrcodeStream"],UseTickets:F},data:function(){return{error:null,orderID:null,selected:null}},computed:{buttonLabel:function(){return this.orderID?"Submit":"Cancel"},buttonVariant:function(){return this.orderID?"primary":"secondary"}},methods:{oidFormatter:function(t){return t.replace(/[^0-9]/g,"")},onDecode:function(t){/\/ticket\/\d\d\d\d-\d\d\d\d-\d\d\d\d$/.test(t)?this.selected=t.substr(t.length-14):window.alert("Not a Schola Cantorum order bar code")},onStreamInit:function(){var t=V(f.a.mark((function t(e){var n=this;return f.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.catch((function(t){"NotAllowedError"===t.name?n.error="no permission to use camera":"NotFoundError"===t.name?n.error="no camera on this device":"NotSupportedError"===t.name?n.error="secure context required (HTTPS, localhost)":"NotReadableError"===t.name?n.error="camera already in use":"OverconstrainedError"===t.name?n.error="camera is not suitable":"StreamApiNotSupportedError"===t.name?n.error="browser can't use camera":n.error="can't start QR code scanner"}));case 2:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),onSubmit:function(){this.orderID?(this.selected=this.orderID,this.orderID=null):this.$emit("done")},onUseDone:function(){this.selected=null}}},X=Y,tt=(n("fb5a"),Object(g["a"])(X,T,D,!1,null,null,null)),et=tt.exports,nt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.order?t.done?n("Receipt",{attrs:{order:t.order},on:{done:function(e){return t.$emit("done")}}}):t.order.id||"cash"!==t.order.payments[0].type?t.order.id||"check"!==t.order.payments[0].type?n("PaymentCard",{attrs:{order:t.order},on:{paid:t.onPaid,cancel:function(e){return t.$emit("done")}}}):n("PaymentCheck",{attrs:{order:t.order},on:{paid:function(e){return t.$emit("done")},cancel:function(e){return t.$emit("done")}}}):n("PaymentCash",{attrs:{order:t.order},on:{paid:function(e){return t.$emit("done")},cancel:function(e){return t.$emit("done")}}}):n("SInput",{on:{order:t.onOrder,cancel:function(e){return t.$emit("done")}}})},rt=[],st=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",{attrs:{id:"paycard"},on:{submit:function(e){return e.preventDefault(),t.onChargeCard(e)}}},[n("Summary",{attrs:{order:t.order}}),n("div",{ref:"card",attrs:{id:"paycard-card"}}),n("div",{attrs:{id:"paycard-buttons"}},[n("b-button",{staticClass:"paycard-button",attrs:{type:"submit",disabled:t.processing,variant:"primary"},domProps:{textContent:t._s(t.processing?"Charging...":"Charge Card")}}),n("b-button",{staticClass:"paycard-button",attrs:{disabled:t.processing},on:{click:function(e){return t.$emit("cancel")}}},[t._v("Cancel")])],1),n("div",{attrs:{id:"paycard-error"},domProps:{textContent:t._s(t.cardError)}})],1)},at=[],ot=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"ssummary"}},[n("div",{attrs:{id:"ssummary-lines"}},t._l(t.lines,(function(e,r){return n("div",{key:r,staticClass:"ssummary-line",domProps:{textContent:t._s(e)}})})),0),n("div",{attrs:{id:"ssummary-total"},domProps:{textContent:t._s("TOTAL $"+t.salesTotal/100)}})])},it=[],ct={props:{order:Object},computed:{lines:function(){var t=this;return this.order.lines.map((function(e){var n=t.$store.state.products.find((function(t){return t.id===e.product})).name;return"".concat(e.quantity,"× ").concat(n)}))},salesTotal:function(){return this.order.payments?this.order.payments[0].amount:0}}},ut=ct,lt=(n("b87a"),Object(g["a"])(ut,ot,it,!1,null,null,null)),dt=lt.exports;function pt(t,e,n,r,s,a,o){try{var i=t[a](o),c=i.value}catch(u){return void n(u)}i.done?e(c):Promise.resolve(c).then(r,s)}function ht(t){return function(){var e=this,n=arguments;return new Promise((function(r,s){var a=t.apply(e,n);function o(t){pt(a,r,s,o,i,"next",t)}function i(t){pt(a,r,s,o,i,"throw",t)}o(void 0)}))}}var ft={components:{Summary:dt},props:{order:Object},data:function(){return{card:null,cardChange:null,cardFocus:!1,elements:null,error:null,processing:!1,submitted:!1}},mounted:function(){var t=this;H||(H=Stripe(this.$store.state.stripeKey)),this.elements=H.elements(),this.card=this.elements.create("card",{style:{base:{fontSize:"16px",lineHeight:1.5}},hidePostalCode:!0}),this.card.on("change",this.onCardChange),this.card.on("focus",(function(){t.cardFocus=!0})),this.card.on("blur",(function(){t.cardFocus=!1})),this.card.on("ready",(function(){t.card.focus()})),this.$nextTick((function(){t.card.mount(t.$refs.card)}))},computed:{cardError:function(){return this.error?this.error:this.cardChange&&this.cardChange.error?this.cardChange.error.message:this.submitted?!this.cardChange||this.cardChange.empty?"Please enter the payment card number.":this.cardFocus||this.cardChange.complete?null:"This card number is incomplete.":null}},methods:{onCardChange:function(t){this.cardChange=t},onChargeCard:function(){var t=ht(f.a.mark((function t(){var e,n,r,s;return f.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.submitted=!0,this.error=null,!this.cardError){t.next=4;break}return t.abrupt("return");case 4:return this.processing=!0,this.card.update({disabled:!0}),t.next=8,H.createPaymentMethod("card",this.card);case 8:if(e=t.sent,n=e.paymentMethod,r=e.error,!r){t.next=17;break}return console.error(r),this.processing=!1,this.card.update({disabled:!1}),"card_error"===r.type||"validation_error"===r.type?this.error=r.message:this.error="Server error, unable to process payment",t.abrupt("return");case 17:return this.order.payments[0].method=n.id,t.prev=18,t.next=21,this.$axios.post("/api/order",this.order,{headers:{Auth:this.$store.state.auth}});case 21:if(s=t.sent.data,!s.error){t.next=28;break}return this.processing=!1,console.error(s.error),this.card.update({disabled:!1}),this.error=s.error,t.abrupt("return");case 28:this.$store.commit("sold",{count:s.lines.reduce((function(t,e){return e.quantity+t}),0),amount:s.payments[0].amount,method:"card"}),this.$emit("paid",s),t.next=42;break;case 32:if(t.prev=32,t.t0=t["catch"](18),this.processing=!1,this.card.update({disabled:!1}),!t.t0.response||401!==t.t0.response.status){t.next=40;break}return this.$store.commit("logout"),window.alert("Login session expired"),t.abrupt("return");case 40:console.error("Error placing order",t.t0),window.alert("Server error: ".concat(t.t0.toString()));case 42:case"end":return t.stop()}}),t,this,[[18,32]])})));function e(){return t.apply(this,arguments)}return e}()}},mt=ft,vt=(n("a31d"),Object(g["a"])(mt,st,at,!1,null,null,null)),bt=vt.exports,yt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"paycash"}},[n("Summary",{attrs:{order:t.order}}),n("div",{staticClass:"paycash-row"},[n("div",{staticClass:"paycash-label"},[t._v("Amount Due")]),n("div",{attrs:{id:"paycash-due"},domProps:{textContent:t._s("$"+t.due)}})]),n("div",{staticClass:"paycash-row"},[n("div",{staticClass:"paycash-label"},[t._v("Cash Received")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.received,expression:"received"}],attrs:{id:"paycash-received",autocomplete:"off",formatter:t.numFormatter,inputmode:"numeric",pattern:"[0-9]*"},domProps:{value:t.received},on:{input:function(e){e.target.composing||(t.received=e.target.value)}}}),t._l(t.rounded,(function(e){return n("b-button",{key:e,staticClass:"paycash-round",attrs:{variant:"outline-primary"},domProps:{textContent:t._s("$"+e)},on:{click:function(n){return t.setReceived(e)}}})}))],2),n("div",{staticClass:"paycash-row"},[n("div",{staticClass:"paycash-label"},[t._v("Change")]),n("div",{attrs:{id:"paycash-change"},domProps:{textContent:t._s("$"+t.change)}}),n("b-form-checkbox",{staticClass:"ml-3",attrs:{id:"paycash-donate",disabled:!t.change,size:"lg",switch:""},model:{value:t.donate,callback:function(e){t.donate=e},expression:"donate"}},[t._v("Donation")])],1),n("div",{attrs:{id:"paycash-buttons"}},[n("b-button",{staticClass:"paycash-button",attrs:{disabled:!t.canConfirm,variant:"primary"},domProps:{textContent:t._s(t.confirmed?"Saving...":"Confirm")},on:{click:t.onConfirmed}}),n("b-button",{staticClass:"paycash-button",attrs:{disabled:t.confirmed},on:{click:function(e){return t.$emit("cancel")}}},[t._v("Cancel")])],1)],1)},gt=[];function wt(t){return xt(t)||kt(t)||Ct()}function Ct(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function kt(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function xt(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}function St(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Pt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?St(n,!0).forEach((function(e){$t(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):St(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function $t(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _t(t,e,n,r,s,a,o){try{var i=t[a](o),c=i.value}catch(u){return void n(u)}i.done?e(c):Promise.resolve(c).then(r,s)}function At(t){return function(){var e=this,n=arguments;return new Promise((function(r,s){var a=t.apply(e,n);function o(t){_t(a,r,s,o,i,"next",t)}function i(t){_t(a,r,s,o,i,"throw",t)}o(void 0)}))}}var Ot={components:{Summary:dt},props:{order:Object},data:function(){return{confirmed:!1,donate:!1,received:0}},mounted:function(){this.received=this.order.payments[0].amount/100},computed:{canConfirm:function(){return this.received>=this.due&&!this.confirmed},change:function(){return this.received<this.due?0:this.received-this.due},due:function(){return this.order.payments[0].amount/100},rounded:function(){var t=this.order.payments[0].amount/100,e=[],n=5*Math.ceil(t/5);n!==t&&e.push(n);var r=20*Math.ceil(t/20);return r!==n&&e.push(r),e}},methods:{numFormatter:function(t){return t.replace(/[^0-9]/g,"")},onConfirmed:function(){var t=At(f.a.mark((function t(){var e,n;return f.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.confirmed=!0,t.prev=1,e=Pt({},this.order),this.change&&this.donate&&(e.lines=wt(e.lines),e.lines.push({product:"donation",quantity:1,price:100*this.change}),e.payments=[Pt({},e.payments[0])],e.payments[0].amount+=100*this.change),t.next=6,this.$axios.post("/api/order",e,{headers:{Auth:this.$store.state.auth}});case 6:if(n=t.sent.data,!n.error){t.next=9;break}throw n.error;case 9:this.$store.commit("sold",{count:this.order.lines.reduce((function(t,e){return e.quantity+t}),0),amount:this.order.payments[0].amount,method:this.order.payments[0].subtype}),this.$emit("paid",n),t.next=22;break;case 13:if(t.prev=13,t.t0=t["catch"](1),this.confirmed=!1,!t.t0.response||401!==t.t0.response.status){t.next=20;break}return this.$store.commit("logout"),window.alert("Login session expired"),t.abrupt("return");case 20:console.error("Error placing order",t.t0),window.alert("Server error: ".concat(t.t0.toString()));case 22:case"end":return t.stop()}}),t,this,[[1,13]])})));function e(){return t.apply(this,arguments)}return e}(),setReceived:function(t){this.received=t}}},Et=Ot,jt=(n("f5b6"),Object(g["a"])(Et,yt,gt,!1,null,null,null)),Tt=jt.exports,Dt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"paycheck"}},[n("Summary",{attrs:{order:t.order}}),n("div",{staticClass:"paycheck-row"},[n("div",{staticClass:"paycheck-label"},[t._v("Amount Due")]),n("div",{attrs:{id:"paycheck-due"},domProps:{textContent:t._s("$"+t.due)}})]),n("div",{staticClass:"paycheck-row"},[n("div",{staticClass:"paycheck-label"},[t._v("Check Amount")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.received,expression:"received"}],attrs:{id:"paycheck-received",autocomplete:"off",formatter:t.numFormatter,inputmode:"numeric",pattern:"[0-9]*"},domProps:{value:t.received},on:{input:function(e){e.target.composing||(t.received=e.target.value)}}})]),t.donation?n("div",{staticClass:"paycheck-row"},[n("div",{staticClass:"paycheck-label"},[t._v("Donation")]),n("div",{attrs:{id:"paycheck-donation"},domProps:{textContent:t._s("$"+t.donation)}})]):t._e(),n("div",{attrs:{id:"paycheck-buttons"}},[n("b-button",{staticClass:"paycheck-button",attrs:{disabled:!t.canConfirm,variant:"primary"},domProps:{textContent:t._s(t.confirmed?"Saving...":"Confirm")},on:{click:t.onConfirmed}}),n("b-button",{staticClass:"paycheck-button",attrs:{disabled:t.confirmed},on:{click:function(e){return t.$emit("cancel")}}},[t._v("Cancel")])],1)],1)},qt=[];function Ut(t){return Zt(t)||Nt(t)||Lt()}function Lt(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function Nt(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function Zt(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}function zt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function It(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?zt(n,!0).forEach((function(e){Jt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):zt(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Jt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mt(t,e,n,r,s,a,o){try{var i=t[a](o),c=i.value}catch(u){return void n(u)}i.done?e(c):Promise.resolve(c).then(r,s)}function Qt(t){return function(){var e=this,n=arguments;return new Promise((function(r,s){var a=t.apply(e,n);function o(t){Mt(a,r,s,o,i,"next",t)}function i(t){Mt(a,r,s,o,i,"throw",t)}o(void 0)}))}}var Rt={components:{Summary:dt},props:{order:Object},data:function(){return{confirmed:!1,received:0}},mounted:function(){this.received=this.order.payments[0].amount/100},computed:{canConfirm:function(){return this.received>=this.due&&!this.confirmed},donation:function(){return this.received<this.due?0:this.received-this.due},due:function(){return this.order.payments[0].amount/100}},methods:{numFormatter:function(t){return t.replace(/[^0-9]/g,"")},onConfirmed:function(){var t=Qt(f.a.mark((function t(){var e,n;return f.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.confirmed=!0,t.prev=1,e=It({},this.order),this.donation&&(e.lines=Ut(e.lines),e.lines.push({product:"donation",quantity:1,price:100*this.donation}),e.payments=[It({},e.payments[0])],e.payments[0].amount+=100*this.donation),t.next=6,this.$axios.post("/api/order",e,{headers:{Auth:this.$store.state.auth}});case 6:if(n=t.sent.data,!n.error){t.next=9;break}throw n.error;case 9:this.$store.commit("sold",{count:this.order.lines.reduce((function(t,e){return e.quantity+t}),0),amount:n.payments[0].amount,method:n.payments[0].subtype}),this.$emit("paid",n),t.next=22;break;case 13:if(t.prev=13,t.t0=t["catch"](1),this.confirmed=!1,!t.t0.response||401!==t.t0.response.status){t.next=20;break}return this.$store.commit("logout"),window.alert("Login session expired"),t.abrupt("return");case 20:console.error("Error placing order",t.t0),window.alert("Server error: ".concat(t.t0.toString()));case 22:case"end":return t.stop()}}),t,this,[[1,13]])})));function e(){return t.apply(this,arguments)}return e}(),setReceived:function(t){this.received=t}}},Kt=Rt,Bt=(n("d0ad"),Object(g["a"])(Kt,Dt,qt,!1,null,null,null)),Wt=Bt.exports,Ft=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"sinput"}},[t._l(t.$store.state.products,(function(e){return n("TicketQuantity",{key:e.id,attrs:{count:e.ticketCount,product:e,sell:t.sellqty[e.id],use:t.useqty[e.id]},on:{change:t.onChange}})})),n("div",{attrs:{id:"sinput-total"},domProps:{textContent:t._s("TOTAL $"+t.salesTotal/100)}}),t.needNameEmail?n("div",{attrs:{id:"sinput-name-email"}},[n("b-form-group",{attrs:{label:"Name","label-for":"sinput-name","label-cols":"2"}},[n("b-form-input",{attrs:{id:"sinput-name",autocomplete:"off"},model:{value:t.name,callback:function(e){t.name="string"===typeof e?e.trim():e},expression:"name"}})],1),n("b-form-group",{attrs:{label:"Email","label-for":"sinput-email","label-cols":"2"}},[n("b-form-input",{attrs:{id:"sinput-email",type:"email",autocomplete:"off"},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}})],1)],1):t._e(),n("div",{attrs:{id:"sinput-buttons"}},[t.$store.state.allow.cash?n("b-button",{staticClass:"sinput-button",attrs:{disabled:!t.canCash,variant:"primary"},on:{click:t.onCash}},[t._v("Cash")]):t._e(),t.$store.state.allow.cash?n("b-button",{staticClass:"sinput-button",attrs:{disabled:!t.canCheck,variant:"primary"},on:{click:t.onCheck}},[t._v("Check")]):t._e(),t.$store.state.allow.card?n("b-button",{staticClass:"sinput-button",attrs:{disabled:!t.canCard,variant:"primary"},on:{click:t.onCard}},[t._v("Card")]):t._e(),n("b-button",{staticClass:"sinput-button",on:{click:function(e){return t.$emit("cancel")}}},[t._v("Cancel")])],1)],2)},Gt=[],Vt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"tqty"},[n("div",{staticClass:"tqty-name-box"},[n("div",{staticClass:"tqty-name",domProps:{textContent:t._s(t.productName)}}),t.productSubName?n("div",{staticClass:"tqty-subname",domProps:{textContent:t._s(t.productSubName)}}):t._e()]),n("b-button",{staticClass:"tqty-button",attrs:{variant:"primary"},on:{click:t.onSellDown}},[t._v("–")]),n("div",{staticClass:"tqty-qty",domProps:{textContent:t._s(t.sell||"0")}}),n("b-button",{staticClass:"tqty-button",attrs:{variant:"primary"},on:{click:t.onSellUp}},[t._v("+")]),n("div",{class:t.priceClass,domProps:{textContent:t._s(t.priceFmt)}})],1),t.showUse?n("div",{staticClass:"tqty"},[n("div",{staticClass:"tqty-and-use"},[t._v("and use")]),n("b-button",{staticClass:"tqty-button",attrs:{variant:"info"},on:{click:t.onUseDown}},[t._v("–")]),n("div",{staticClass:"tqty-qty",domProps:{textContent:t._s(t.use||"0")}}),n("b-button",{staticClass:"tqty-button",attrs:{variant:"info"},on:{click:t.onUseUp}},[t._v("+")]),n("div",{staticClass:"tqty-amount"},[t._v(" ")])],1):t._e()])},Ht=[],Yt={props:{product:Object,count:Number,sell:Number,use:Number},computed:{priceClass:function(){return this.sell?"tqty-amount":"tqty-price"},priceFmt:function(){return this.sell?"$".concat(this.sell*this.product.price/100):"$".concat(this.product.price/100)},productName:function(){return this.product.name.split("\n")[0]},productSubName:function(){var t=this.product.name.split("\n");return t.length>1?t[1]:""},showUse:function(){return this.sell&&this.count>1||this.sell>1}},methods:{onSellDown:function(){if(this.sell){var t=this.sell-1,e=Math.min(t*this.count,this.use);this.$emit("change",{product:this.product,sell:t,use:e})}},onSellUp:function(){this.$emit("change",{product:this.product,sell:(this.sell||0)+1,use:(this.use||0)+1})},onUseDown:function(){this.use&&this.$emit("change",{product:this.product,sell:this.sell,use:this.use-1})},onUseUp:function(){this.use>=this.count*this.sell||this.$emit("change",{product:this.product,sell:this.sell,use:(this.use||0)+1})}}},Xt=Yt,te=(n("2285"),Object(g["a"])(Xt,Vt,Ht,!1,null,null,null)),ee=te.exports,ne={components:{TicketQuantity:ee},data:function(){return{email:"",name:"",sellqty:{},useqty:{}}},computed:{canCard:function(){return this.salesTotal&&this.haveNameEmail},canCash:function(){return this.sellQtyTotal&&this.haveNameEmail},canCheck:function(){return this.salesTotal&&this.haveNameEmail},haveNameEmail:function(){return!this.needNameEmail||!!this.name&&!!this.email.match(/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/)},needNameEmail:function(){var t=this;return this.$store.state.products.some((function(e){return(t.sellqty[e.id]||0)*e.ticketCount>(t.useqty[e.id]||0)}))},sellQtyTotal:function(){var t=this;return this.$store.state.products.reduce((function(e,n){return e+(t.sellqty[n.id]||0)}),0)},salesTotal:function(){var t=this;return this.$store.state.products.reduce((function(e,n){return e+n.price*(t.sellqty[n.id]||0)}),0)}},methods:{onCard:function(){this.sendOrder("card","manual")},onCash:function(){this.sendOrder("cash","")},onCheck:function(){this.sendOrder("check","")},onChange:function(t){var e=t.product,n=t.sell,r=t.use;this.$set(this.sellqty,e.id,n),this.$set(this.useqty,e.id,r)},sendOrder:function(t,e){var n=this;this.$emit("order",{source:"inperson",name:this.name,email:this.email,payments:[{type:t,subtype:e,amount:this.salesTotal}],lines:this.$store.state.products.filter((function(t){return n.sellqty[t.id]})).map((function(t){return{product:t.id,quantity:n.sellqty[t.id],used:n.useqty[t.id],usedAt:n.$store.state.event.id,price:t.price}}))})}}},re=ne,se=(n("ac68"),Object(g["a"])(re,Ft,Gt,!1,null,null,null)),ae=se.exports,oe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",{attrs:{id:"receipt"},on:{submit:function(e){return e.preventDefault(),t.onSendReceipt(e)}}},[n("Summary",{attrs:{order:t.order}}),n("b-form-input",{attrs:{id:"receipt-email",type:"email",autocomplete:"off",autoCapitalize:"none",autoCorrect:!1,autofocus:"",placeholder:"Email address"},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}}),n("div",{attrs:{id:"receipt-buttons"}},[n("b-button",{staticClass:"receipt-button",attrs:{type:"submit",disabled:!t.validEmail||t.sending,variant:"primary"},domProps:{textContent:t._s(t.sending?"Sending...":"Send Receipt")}}),n("b-button",{staticClass:"receipt-button",on:{click:function(e){return t.$emit("done")}}},[t._v("No Receipt")])],1)],1)},ie=[];function ce(t,e,n,r,s,a,o){try{var i=t[a](o),c=i.value}catch(u){return void n(u)}i.done?e(c):Promise.resolve(c).then(r,s)}function ue(t){return function(){var e=this,n=arguments;return new Promise((function(r,s){var a=t.apply(e,n);function o(t){ce(a,r,s,o,i,"next",t)}function i(t){ce(a,r,s,o,i,"throw",t)}o(void 0)}))}}var le={components:{Summary:dt},props:{order:Object},data:function(){return{email:null,sending:!1}},mounted:function(){this.email=this.order.email},computed:{validEmail:function(){return/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(this.email)}},methods:{onSendReceipt:function(){var t=ue(f.a.mark((function t(){return f.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.validEmail&&!this.sending){t.next=2;break}return t.abrupt("return");case 2:return this.sending=!0,t.prev=3,t.next=6,this.$axios.post("/api/order/".concat(this.order.id,"/sendReceipt"),null,{headers:{Auth:this.$store.state.auth},params:{email:this.email}});case 6:this.$emit("done"),t.next=18;break;case 9:if(t.prev=9,t.t0=t["catch"](3),this.sending=!1,!t.t0.response||401!==t.t0.response.status){t.next=16;break}return this.$store.commit("logout"),window.alert("Login session expired"),t.abrupt("return");case 16:console.error("Error sending receipt",t.t0),window.alert("Server error: ".concat(t.t0.toString()));case 18:case"end":return t.stop()}}),t,this,[[3,9]])})));function e(){return t.apply(this,arguments)}return e}()}},de=le,pe=(n("6933"),Object(g["a"])(de,oe,ie,!1,null,null,null)),he=pe.exports,fe={components:{PaymentCard:bt,PaymentCash:Tt,PaymentCheck:Wt,Receipt:he,SInput:ae},data:function(){return{order:null,done:!1}},methods:{onOrder:function(t){this.order=t},onPaid:function(t){this.done=!0,this.order.email?this.$emit("done"):this.order=t}}},me=fe,ve=Object(g["a"])(me,nt,rt,!1,null,null,null),be=ve.exports,ye=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.orders?t.selected?n("UseTickets",{attrs:{orderID:t.selected},on:{cancel:t.onUseCancel,done:t.onUseDone}}):n("div",{attrs:{id:"willcall"}},[n("b-form-input",{attrs:{id:"willcall-search",autoCapitalize:t.none,autocomplete:"off",autoCorrect:!1,placeholder:"Search Will Call List"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),n("div",{attrs:{id:"willcall-orders"}},[n("div",t._l(t.filteredOrders,(function(e){return n("div",{key:e.id,staticClass:"willcall-order",on:{click:function(n){return t.onSelect(e.id)}}},[t._v(t._s(e.name)),n("span",{staticClass:"willcall-order-num",domProps:{textContent:t._s("#"+e.id)}})])})),0)]),n("b-button",{attrs:{id:"willcall-cancel"},on:{click:function(e){return t.$emit("done")}}},[t._v("Cancel")])],1):n("div",{attrs:{id:"willcall-spinner"}},[n("b-spinner")],1)},ge=[];function we(t,e,n,r,s,a,o){try{var i=t[a](o),c=i.value}catch(u){return void n(u)}i.done?e(c):Promise.resolve(c).then(r,s)}function Ce(t){return function(){var e=this,n=arguments;return new Promise((function(r,s){var a=t.apply(e,n);function o(t){we(a,r,s,o,i,"next",t)}function i(t){we(a,r,s,o,i,"throw",t)}o(void 0)}))}}var ke={components:{UseTickets:F},data:function(){return{orders:null,search:"",selected:null}},mounted:function(){var t=Ce(f.a.mark((function t(){return f.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$axios.get("/api/event/".concat(this.$store.state.event.id,"/orders"),{headers:{Auth:this.$store.state.auth}});case 3:this.orders=t.sent.data,t.next=14;break;case 6:if(t.prev=6,t.t0=t["catch"](0),!t.t0.response||401!==t.t0.response.status){t.next=12;break}return this.$store.commit("logout"),window.alert("Login session expired"),t.abrupt("return");case 12:console.error("Error getting will call list",t.t0),window.alert("Server error: ".concat(t.t0.toString()));case 14:case"end":return t.stop()}}),t,this,[[0,6]])})));function e(){return t.apply(this,arguments)}return e}(),computed:{filteredOrders:function(){var t=this;return this.search.trim()?this.orders.filter((function(e){return e.name.toLowerCase().includes(t.search.toLowerCase())||parseInt(t.search)===e.id})):this.orders}},methods:{onSelect:function(t){this.selected=t},onUseCancel:function(){this.selected=null},onUseDone:function(){this.$emit("done")}}},xe=ke,Se=(n("76c6"),Object(g["a"])(xe,ye,ge,!1,null,null,null)),Pe=Se.exports,$e={components:{ScanTickets:et,SellTickets:be,WillCall:Pe},data:function(){return{mode:null}},computed:{canSellTickets:function(){return this.$store.state.allow.card||this.$storestate.allow.cash},canWillCall:function(){return this.$store.state.allow.willcall},eventHeader:function(){return"".concat(this.$store.state.event.start.substr(0,10)," ").concat(this.$store.state.event.name)},stats:function(){return"Admitted ".concat(this.$store.state.admitted,", sold ").concat(this.$store.state.sold,", cash $").concat(this.$store.state.cash/100,", check $").concat(this.$store.state.check/100)}},methods:{onLogout:function(){this.$store.commit("logout")},onMenu:function(){this.mode=null},onScanTickets:function(){this.mode="scan"},onSellTickets:function(){this.mode="sell"},onWillCall:function(){this.mode="willcall"}}},_e=$e,Ae=(n("2906"),Object(g["a"])(_e,E,j,!1,null,null,null)),Oe=Ae.exports,Ee={components:{ChooseEvent:C,Login:O,Main:Oe},mounted:function(){var t=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(t,"px"))}},je=Ee,Te=(n("7faf"),Object(g["a"])(je,u,l,!1,null,null,null)),De=Te.exports,qe=n("2f62");r["default"].use(qe["a"]);var Ue=new qe["a"].Store({state:{allow:{},auth:null,event:null,products:null,stripeKey:null,username:null,admitted:0,sold:0,cash:0,check:0},mutations:{login:function(t,e){var n=e.allow,r=e.auth,s=e.stripeKey,a=e.username;t.allow=n,t.auth=r,t.stripeKey=s,t.username=a},logout:function(t){t.auth=t.stripeKey=t.username=t.event=t.products=null,t.allow={},t.admitted=t.sold=t.cash=t.check=0},event:function(t,e){var n=e.event,r=e.products;t.event=n,t.products=r},admitted:function(t,e){t.admitted+=e},sold:function(t,e){var n=e.count,r=e.amount,s=e.method;switch(t.sold+=n,t.admitted+=n,s){case"cash":t.cash+=r;break;case"check":t.check+=r;break}}}}),Le=Ue;r["default"].config.productionTip=!1,new r["default"]({store:Le,render:function(t){return t(De)}}).$mount("#app"),window.addEventListener("beforeunload",(function(t){t.preventDefault(),t.returnValue="Leaving this page will log you out."}))},"580c":function(t,e,n){},6933:function(t,e,n){"use strict";var r=n("5666"),s=n.n(r);s.a},7333:function(t,e,n){},"76c6":function(t,e,n){"use strict";var r=n("e882"),s=n.n(r);s.a},"7dfc":function(t,e,n){},"7faf":function(t,e,n){"use strict";var r=n("8fba"),s=n.n(r);s.a},"8dfe":function(t,e,n){},"8fba":function(t,e,n){},"8fd5":function(t,e){t.exports="data:image/png;base64,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"},"996d":function(t,e,n){},"9c64":function(t,e,n){"use strict";var r=n("7dfc"),s=n.n(r);s.a},a31d:function(t,e,n){"use strict";var r=n("19af"),s=n.n(r);s.a},a917:function(t,e,n){},ac68:function(t,e,n){"use strict";var r=n("1abd"),s=n.n(r);s.a},b543:function(t,e,n){"use strict";var r=n("996d"),s=n.n(r);s.a},b87a:function(t,e,n){"use strict";var r=n("54ee"),s=n.n(r);s.a},d0ad:function(t,e,n){"use strict";var r=n("7333"),s=n.n(r);s.a},e882:function(t,e,n){},f13f:function(t,e,n){},f5b6:function(t,e,n){"use strict";var r=n("1e19"),s=n.n(r);s.a},f756:function(t,e,n){"use strict";var r=n("a917"),s=n.n(r);s.a},fb5a:function(t,e,n){"use strict";var r=n("8dfe"),s=n.n(r);s.a}});
//# sourceMappingURL=app.0aa72e21.js.map